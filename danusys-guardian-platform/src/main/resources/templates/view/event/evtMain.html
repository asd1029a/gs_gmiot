<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="utf-8">
<title>관제</title>
	<link rel="stylesheet" type="text/css" href="/css/dark/reset.css">
	<link rel="stylesheet" type="text/css" href="/css/dark/leftList.css">
	<link rel="stylesheet" type="text/css" href="/css/dark/evt.css">
	<link rel="stylesheet" type="text/css" href="/css/jstree/style.css">
	
	<script src="/js/jquery/jquery.min.js"></script>
	<script src="/js/jquery/jquery-ui.js"></script>
	
	<script src="/js/simplePagination/simplePagination.js"></script>
	
	<script src="/js/leftList.js"></script>
	
	<script src="/js/jstree/jstree.js"></script>
	<script src="/js/jstree/jstree.min.js"></script>
</head>

<body>
<div class="wrap">
	<aside class="aside-slide">
		<p class="aside-fold-btn"><img src="../images/icons/asideBtn_fold.png"></p>
		
		<!-- tab button -->
		<div class="aside-tab-btn">
			<ul>
				<li class="active" value="eventM">발생이벤트</li>
				<li value="eventE">종료이벤트</li>
			</ul>
		</div>
		<!-- //tab button -->
		<!-- search form -->
		<div class="aside-srch-form">
			<ul>
				<li>
					<div id="spaceSelect" style="width:calc(50% - 21px);margin-right:10px;float:left;"></div>
					<select id="eventSelect" style="width:calc(50% - 5px);"></select>
				</li>
				<li>
					<input type="text" id="contSearch" placeholder="이벤트내용을 입력하세요">
				</li>
				<li>
					<input type="checkbox" id="mapFlag"><label for="mapFlag"></label>지도 내 검색
				</li>
				<li class="search-btn" onClick="javascript:selectEvent()">조회</li>
			</ul>
		</div>
		<!-- //search form -->
		<!-- search list -->
		<div class="aside-srch-list">
			<dl class="srch-list-tit">
				<dt>
					<span class="title">목록</span>
					<span class="count" id="list_count"></span>
				</dt>
				<dd>
					<a class="log-btn" href="javascript:openLogPopup()">발생이력</a>
					<!-- <select>
						<option selected>발생순</option>
						<option>이벤트별</option>
						<option>행정구역별</option>
					</select> -->
				</dd>
			</dl>
			<article class="srch-list" id="eventList"></article>
			<ul id="eventListPagination"></ul>
		</div>
		<th:block th:insert="view/common/addressSearch :: addressSearch">
		</th:block>
	</aside>
	<th:block th:insert="view/common/map :: map">
	</th:block>
</div>
<th:block th:insert="view/common/socket :: socket">
</th:block>

<script src="/js/event/evtMain.js"></script>
<script th:inline="javascript">
$(document).ready(function(){
	areaCode = [];
	
	$(".aside-fold-btn").click(function(){
		$(".aside-slide").toggleClass("toggled");
		mapManager.map.updateSize();
	});
	
	$('.aside-tab-btn ul li').click(function(){
		$(".aside-tab-btn ul li").removeClass("active");
		$(this).addClass("active");
		
		selectEvent();
		
		mapManager.removeOverlays();
		dialogManager.closeAll();
	});
	
	comboArea('spaceSelect');
	comboEventGbn('eventSelect',[[ ${session.admin.id} ]]);
	
	selectEvent();
	
	mapManager.setMapEventListener('pointermove', evtMapPointermoveListener);
	mapManager.setMapEventListener('click', evtMapClickListener);
	
	var contextItems = [
	  	{
	    	text: '지도 메뉴',
	    	classname: 'first-menu'
	  	},
	  	{
	    	text: '투망감시',
	    	classname: 'context_cast',
	    	callback : castMntr
	  	},
	  	{
			text: '수동발생',
	    	classname: 'context_passive_evt',
			callback : passive
		},
		{
			text: 'TTL 메세지',
			classname: 'context-ttl-msg',
			callback : ttl
		},
		{
			text: '영상종료',
			classname: 'context_video',
			callback : dialogManager.closeAll
		}
	]
	mapManager.createContextMenu(contextItems);
});

function openLogPopup() {
	var page = '/common/popup/eventLogPopup';
	common.openDialogPop('eventLogPopup','상황처리내역','870','700',true,'/action/page',{path : page},'eventLogPopup',function(){
		/* $('#passiveOcrLon').val(coordi.getCoordinates()[0]);
    	$('#passiveOcrLat').val(coordi.getCoordinates()[1]);
    	$('#passiveOcrTime').val(moment().format("YYYYMMDDHHmmss")); */
	})
}

</script>
</body>
</html>

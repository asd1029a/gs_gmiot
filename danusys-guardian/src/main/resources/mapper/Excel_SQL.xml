<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="excel">
	<select id="selectEventByDay" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		<![CDATA[
		SELECT
		 a.gbn AS "gbn"
        ,SUM(CASE WHEN b.time = a.time AND b.time='00'THEN 1 ELSE 0 END) AS "tm0"
        ,SUM(CASE WHEN b.time = a.time AND b.time='01'THEN 1 ELSE 0 END) AS "tm1"
        ,SUM(CASE WHEN b.time = a.time AND b.time='02'THEN 1 ELSE 0 END) AS "tm2"
        ,SUM(CASE WHEN b.time = a.time AND b.time='03'THEN 1 ELSE 0 END) AS "tm3"
        ,SUM(CASE WHEN b.time = a.time AND b.time='04'THEN 1 ELSE 0 END) AS "tm4"
        ,SUM(CASE WHEN b.time = a.time AND b.time='05'THEN 1 ELSE 0 END) AS "tm5"
        ,SUM(CASE WHEN b.time = a.time AND b.time='06'THEN 1 ELSE 0 END) AS "tm6"
        ,SUM(CASE WHEN b.time = a.time AND b.time='07'THEN 1 ELSE 0 END) AS "tm7"
        ,SUM(CASE WHEN b.time = a.time AND b.time='08'THEN 1 ELSE 0 END) AS "tm8"
        ,SUM(CASE WHEN b.time = a.time AND b.time='09'THEN 1 ELSE 0 END) AS "tm9"
        ,SUM(CASE WHEN b.time = a.time AND b.time='10'THEN 1 ELSE 0 END) AS "tm10"
        ,SUM(CASE WHEN b.time = a.time AND b.time='11'THEN 1 ELSE 0 END) AS "tm11"
        ,SUM(CASE WHEN b.time = a.time AND b.time='12'THEN 1 ELSE 0 END) AS "tm12"
        ,SUM(CASE WHEN b.time = a.time AND b.time='13'THEN 1 ELSE 0 END) AS "tm13"
        ,SUM(CASE WHEN b.time = a.time AND b.time='14'THEN 1 ELSE 0 END) AS "tm14"
        ,SUM(CASE WHEN b.time = a.time AND b.time='15'THEN 1 ELSE 0 END) AS "tm15"
        ,SUM(CASE WHEN b.time = a.time AND b.time='16'THEN 1 ELSE 0 END) AS "tm16"
        ,SUM(CASE WHEN b.time = a.time AND b.time='17'THEN 1 ELSE 0 END) AS "tm17"
        ,SUM(CASE WHEN b.time = a.time AND b.time='18'THEN 1 ELSE 0 END) AS "tm18"
        ,SUM(CASE WHEN b.time = a.time AND b.time='19'THEN 1 ELSE 0 END) AS "tm19"
        ,SUM(CASE WHEN b.time = a.time AND b.time='20'THEN 1 ELSE 0 END) AS "tm20"
        ,SUM(CASE WHEN b.time = a.time AND b.time='21'THEN 1 ELSE 0 END) AS "tm21"
        ,SUM(CASE WHEN b.time = a.time AND b.time='22'THEN 1 ELSE 0 END) AS "tm22"
        ,SUM(CASE WHEN b.time = a.time AND b.time='23'THEN 1 ELSE 0 END) AS "tm23"
		FROM(
		]]>
		<if test="sigCode == 'all'">
			SELECT a.SI_NM AS gbn
				 , SUBSTR(b.EVT_OCR_YMD_HMS,9,2) AS TIME
			FROM CM_AREA_SI_CD a
			LEFT OUTER JOIN CM_EVT_OCR b
			ON a.si_cd::text = SUBSTR(b.area_cd,1,5)
		</if>
		<if test="sigCode != 'all'">
			SELECT a.DONG_NM AS gbn
				 , SUBSTR(b.EVT_OCR_YMD_HMS,9,2) AS TIME
			FROM CM_AREA_DONG_CD a
			LEFT OUTER JOIN CM_EVT_OCR b
			ON SUBSTR(a.dong_cd::text,1,8) = SUBSTR(b.area_cd::text,1,8)
			AND a.SI_CD::text = #{sigCode}
		</if>
		<if test="sDate != null and sDate != ''" ><![CDATA[
      		AND #{sDate} <= TO_CHAR(TO_DATE(b.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
			AND #{eDate} >= TO_CHAR(TO_DATE(b.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		<![CDATA[
		) a
		CROSS JOIN(
			SELECT LPAD(generate_series(0,23)::text,2,'0') as "time"
 		) b
	 	GROUP BY a.gbn
		ORDER BY a.gbn
		]]>
	</select>
	
	<select id="selectEventByWeek" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		<![CDATA[
		SELECT
		 a.gbn AS "gbn"
        ,SUM(CASE WHEN b.time = a.time AND b.time='1'THEN 1 ELSE 0 END) AS "sun"
        ,SUM(CASE WHEN b.time = a.time AND b.time='2'THEN 1 ELSE 0 END) AS "mon"
        ,SUM(CASE WHEN b.time = a.time AND b.time='3'THEN 1 ELSE 0 END) AS "tue"
        ,SUM(CASE WHEN b.time = a.time AND b.time='4'THEN 1 ELSE 0 END) AS "wed"
        ,SUM(CASE WHEN b.time = a.time AND b.time='5'THEN 1 ELSE 0 END) AS "thu"
        ,SUM(CASE WHEN b.time = a.time AND b.time='6'THEN 1 ELSE 0 END) AS "fri"
        ,SUM(CASE WHEN b.time = a.time AND b.time='7'THEN 1 ELSE 0 END) AS "sat"
		FROM(
		]]>
		<if test="sigCode == 'all'">
			SELECT a.SI_NM AS gbn
				 , TO_CHAR(SUBSTR(b.EVT_OCR_YMD_HMS,1,8)::date, 'D') AS "time"
			FROM CM_AREA_SI_CD a
			LEFT OUTER JOIN
			CM_EVT_OCR b
			ON a.si_cd::text = SUBSTR(b.area_cd::text,1,5)
		</if>
		<if test="sigCode != 'all'">
			SELECT 
				a.DONG_NM AS gbn
				, TO_CHAR(SUBSTR(b.EVT_OCR_YMD_HMS,1,8)::date,'D') AS "time"
			FROM CM_AREA_DONG_CD a
			LEFT OUTER JOIN CM_EVT_OCR b
			ON SUBSTR(a.dong_cd::text,1,8) = SUBSTR(b.area_cd::text,1,8)
			AND a.SI_CD::text = #{sigCode}
		</if>
		<if test="sDate != null and sDate != ''" ><![CDATA[
      		AND #{sDate} <= TO_CHAR(TO_DATE(b.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
			AND #{eDate} >= TO_CHAR(TO_DATE(b.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		<![CDATA[
		) a
		CROSS JOIN(
			SELECT GENERATE_SERIES(1,7)::text AS "time"
 		)b
	 	GROUP BY a.gbn
		ORDER BY a.gbn
		]]>
	</select>
	
	<select id="selectEventByMon" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		<![CDATA[
		SELECT
			a.gbn AS "gbn"
			,SUM(CASE WHEN b.time = a.time AND b.time='01'THEN 1 ELSE 0 END) AS "jan"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='02'THEN 1 ELSE 0 END) AS "feb"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='03'THEN 1 ELSE 0 END) AS "mar"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='04'THEN 1 ELSE 0 END) AS "apr"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='05'THEN 1 ELSE 0 END) AS "may"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='06'THEN 1 ELSE 0 END) AS "jun"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='07'THEN 1 ELSE 0 END) AS "jul"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='08'THEN 1 ELSE 0 END) AS "aug"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='09'THEN 1 ELSE 0 END) AS "sep"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='10'THEN 1 ELSE 0 END) AS "oct"
	       	,SUM(CASE WHEN b.time = a.time AND b.time='11'THEN 1 ELSE 0 END) AS "nov"
			,SUM(CASE WHEN b.time = a.time AND b.time='12'THEN 1 ELSE 0 END) AS "dec"
		FROM(
		]]>
		<if test="sigCode == 'all'">
			SELECT 
				a.SI_NM AS gbn
				,SUBSTR(b.EVT_OCR_YMD_HMS::text,5,2) AS "time"
			FROM 
				CM_AREA_SI_CD a
			LEFT OUTER JOIN 
				CM_EVT_OCR b
			ON a.si_cd::text = SUBSTR(b.area_cd::text,1,5)
		</if>
		<if test="sigCode != 'all'">
			SELECT a.DONG_NM AS gbn
				 , SUBSTR(b.EVT_OCR_YMD_HMS,5,2) AS "time"
			FROM CM_AREA_DONG_CD a
			LEFT OUTER JOIN CM_EVT_OCR b
			ON SUBSTR(a.dong_cd::text,1,8) = SUBSTR(b.area_cd::text,1,8)
			AND a.SI_CD::text = #{sigCode}
		</if>
		<if test="sDate != null and sDate != ''" ><![CDATA[
      		AND #{sDate} <= TO_CHAR(TO_DATE(b.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
			AND #{eDate} >= TO_CHAR(TO_DATE(b.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		<![CDATA[
		) a
		CROSS JOIN(
			SELECT LPAD(GENERATE_SERIES(1,12)::text,2,'0')::text AS "time"
 		) b
	 	GROUP BY a.gbn
		ORDER BY a.gbn
		]]>
	</select>
	
	<select id="selectFacilityByDay" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		<![CDATA[
		SELECT
		 a.gbn AS "gbn"
        ,SUM(CASE WHEN b.time = a.time AND b.time='00'THEN 1 ELSE 0 END) AS "tm0"
        ,SUM(CASE WHEN b.time = a.time AND b.time='01'THEN 1 ELSE 0 END) AS "tm1"
        ,SUM(CASE WHEN b.time = a.time AND b.time='02'THEN 1 ELSE 0 END) AS "tm2"
        ,SUM(CASE WHEN b.time = a.time AND b.time='03'THEN 1 ELSE 0 END) AS "tm3"
        ,SUM(CASE WHEN b.time = a.time AND b.time='04'THEN 1 ELSE 0 END) AS "tm4"
        ,SUM(CASE WHEN b.time = a.time AND b.time='05'THEN 1 ELSE 0 END) AS "tm5"
        ,SUM(CASE WHEN b.time = a.time AND b.time='06'THEN 1 ELSE 0 END) AS "tm6"
        ,SUM(CASE WHEN b.time = a.time AND b.time='07'THEN 1 ELSE 0 END) AS "tm7"
        ,SUM(CASE WHEN b.time = a.time AND b.time='08'THEN 1 ELSE 0 END) AS "tm8"
        ,SUM(CASE WHEN b.time = a.time AND b.time='09'THEN 1 ELSE 0 END) AS "tm9"
        ,SUM(CASE WHEN b.time = a.time AND b.time='10'THEN 1 ELSE 0 END) AS "tm10"
        ,SUM(CASE WHEN b.time = a.time AND b.time='11'THEN 1 ELSE 0 END) AS "tm11"
        ,SUM(CASE WHEN b.time = a.time AND b.time='12'THEN 1 ELSE 0 END) AS "tm12"
        ,SUM(CASE WHEN b.time = a.time AND b.time='13'THEN 1 ELSE 0 END) AS "tm13"
        ,SUM(CASE WHEN b.time = a.time AND b.time='14'THEN 1 ELSE 0 END) AS "tm14"
        ,SUM(CASE WHEN b.time = a.time AND b.time='15'THEN 1 ELSE 0 END) AS "tm15"
        ,SUM(CASE WHEN b.time = a.time AND b.time='16'THEN 1 ELSE 0 END) AS "tm16"
        ,SUM(CASE WHEN b.time = a.time AND b.time='17'THEN 1 ELSE 0 END) AS "tm17"
        ,SUM(CASE WHEN b.time = a.time AND b.time='18'THEN 1 ELSE 0 END) AS "tm18"
        ,SUM(CASE WHEN b.time = a.time AND b.time='19'THEN 1 ELSE 0 END) AS "tm19"
        ,SUM(CASE WHEN b.time = a.time AND b.time='20'THEN 1 ELSE 0 END) AS "tm20"
        ,SUM(CASE WHEN b.time = a.time AND b.time='21'THEN 1 ELSE 0 END) AS "tm21"
        ,SUM(CASE WHEN b.time = a.time AND b.time='22'THEN 1 ELSE 0 END) AS "tm22"
        ,SUM(CASE WHEN b.time = a.time AND b.time='23'THEN 1 ELSE 0 END) AS "tm23"
		FROM(
			SELECT d.DE_CD_NM AS gbn
				 , SUBSTR(TO_CHAR(c.INSERT_DATE,'YYYYMMDDHH24MISS'),9,2) AS "time"
			FROM CCTV_BRK_LOG c
			INNER JOIN FACILITY_S s
			ON c.FCLT_ID = s.FCLT_ID
			AND s.AREA_CD IS NOT NULL
		]]>
		<if test="sigCode != 'all'">
			AND SUBSTR(s.AREA_CD::text, 0, 5) = #{sigCode}
		</if>
		<![CDATA[
			INNER JOIN DETAIL_CD d
			ON c.PURPOSE = d.DE_CD
		]]>
		<if test="sDate != null and sDate != ''" ><![CDATA[
      		AND #{sDate} <= TO_CHAR(c.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
			AND #{eDate} >= TO_CHAR(c.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		<![CDATA[
		) a
		CROSS JOIN(
			SELECT LPAD(GENERATE_SERIES(0,23)::text,2,'0') AS "time"
 		) b
	 	GROUP BY a.gbn
		ORDER BY a.gbn
		]]>
	</select>
	
	<select id="selectFacilityByWeek" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		<![CDATA[
		SELECT
		 a.gbn AS "gbn"
        ,SUM(CASE WHEN b.time = a.time AND b.time='1'THEN 1 ELSE 0 END) AS "sun"
        ,SUM(CASE WHEN b.time = a.time AND b.time='2'THEN 1 ELSE 0 END) AS "mon"
        ,SUM(CASE WHEN b.time = a.time AND b.time='3'THEN 1 ELSE 0 END) AS "tue"
        ,SUM(CASE WHEN b.time = a.time AND b.time='4'THEN 1 ELSE 0 END) AS "wed"
        ,SUM(CASE WHEN b.time = a.time AND b.time='5'THEN 1 ELSE 0 END) AS "thu"
        ,SUM(CASE WHEN b.time = a.time AND b.time='6'THEN 1 ELSE 0 END) AS "fri"
        ,SUM(CASE WHEN b.time = a.time AND b.time='7'THEN 1 ELSE 0 END) AS "sat"
		FROM(
			SELECT d.DE_CD_NM AS gbn
				 , TO_CHAR(c.INSERT_DATE,'D') AS TIME
			FROM CCTV_BRK_LOG c
			INNER JOIN FACILITY_S s
			ON c.FCLT_ID = s.FCLT_ID
			AND s.AREA_CD IS NOT NULL
		]]>
		<if test="sigCode != 'all'">
			AND SUBSTR(s.AREA_CD::text, 0, 5) = #{sigCode}
		</if>
		<![CDATA[
			INNER JOIN DETAIL_CD d
			ON c.PURPOSE = d.DE_CD
		]]>
		<if test="sDate != null and sDate != ''" ><![CDATA[
      		AND #{sDate} <= TO_CHAR(c.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
			AND #{eDate} >= TO_CHAR(c.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		<![CDATA[
		) a
		CROSS JOIN(
			SELECT GENERATE_SERIES(1,7)::text AS "time"
 		)b
	 	GROUP BY a.gbn
		ORDER BY a.gbn
		]]>
	</select>
	
	<select id="selectFacilityByMon" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		<![CDATA[
		SELECT
		 a.gbn AS "gbn"
        ,SUM(CASE WHEN b.time = a.time AND b.time='01'THEN 1 ELSE 0 END) AS "jan"
        ,SUM(CASE WHEN b.time = a.time AND b.time='02'THEN 1 ELSE 0 END) AS "feb"
        ,SUM(CASE WHEN b.time = a.time AND b.time='03'THEN 1 ELSE 0 END) AS "mar"
        ,SUM(CASE WHEN b.time = a.time AND b.time='04'THEN 1 ELSE 0 END) AS "apr"
        ,SUM(CASE WHEN b.time = a.time AND b.time='05'THEN 1 ELSE 0 END) AS "may"
        ,SUM(CASE WHEN b.time = a.time AND b.time='06'THEN 1 ELSE 0 END) AS "jun"
        ,SUM(CASE WHEN b.time = a.time AND b.time='07'THEN 1 ELSE 0 END) AS "jul"
        ,SUM(CASE WHEN b.time = a.time AND b.time='08'THEN 1 ELSE 0 END) AS "aug"
        ,SUM(CASE WHEN b.time = a.time AND b.time='09'THEN 1 ELSE 0 END) AS "sep"
        ,SUM(CASE WHEN b.time = a.time AND b.time='10'THEN 1 ELSE 0 END) AS "oct"
        ,SUM(CASE WHEN b.time = a.time AND b.time='11'THEN 1 ELSE 0 END) AS "nov"
        ,SUM(CASE WHEN b.time = a.time AND b.time='12'THEN 1 ELSE 0 END) AS "dec"
		FROM(
			SELECT d.DE_CD_NM AS gbn
				 , SUBSTR(TO_CHAR(c.INSERT_DATE,'YYYYMMDDHH24MISS'),5,2) AS "time"
			FROM CCTV_BRK_LOG c
			INNER JOIN FACILITY_S s
			ON c.FCLT_ID = s.FCLT_ID
			AND s.AREA_CD IS NOT NULL
		]]>
		<if test="sigCode != 'all'">
			AND SUBSTR(s.AREA_CD::text, 0, 5) = #{sigCode}
		</if>
		<![CDATA[
			INNER JOIN DETAIL_CD d
			ON c.PURPOSE = d.DE_CD
		]]>
		<if test="sDate != null and sDate != ''" ><![CDATA[
      		AND #{sDate} <= TO_CHAR(c.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
			AND #{eDate} >= TO_CHAR(c.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		<![CDATA[
		) a
		CROSS JOIN(
			SELECT LPAD(GENERATE_SERIES(1,12)::text,2,'0') AS "time"
 		)b
	 	GROUP BY a.gbn
		ORDER BY a.gbn
		]]>
	</select>
	
	<select id="selectEventMapBySi" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		SELECT a.SI_NM as "area", e.EVT_NM as "gbn", SUM(1) AS "cnt"
		FROM CM_EVT_OCR o
		INNER JOIN  CM_AREA_SI_CD a
		ON SUBSTR(o.AREA_CD::text,1,5) = a.SI_CD::text
		LEFT OUTER JOIN CM_EVENT e
		ON o.EVT_ID = e.EVT_ID
		WHERE 1=1
		<if test="sDate != null and sDate != ''" ><![CDATA[
      	AND #{sDate} <= TO_CHAR(TO_DATE(o.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
		AND #{eDate} >= TO_CHAR(TO_DATE(o.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		GROUP BY a.SI_NM, e.EVT_NM
		ORDER BY a.SI_NM
	</select>
	
	<select id="selectEventMapByDong" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		SELECT a.DONG_NM as "area", e.EVT_NM as "gbn", SUM(1) AS "cnt"
		FROM CM_EVT_OCR o
		INNER JOIN CM_AREA_DONG_CD a
		ON o.AREA_CD::text = a.DONG_CD::text
		AND a.SI_CD::text = #{sigCode}
		LEFT OUTER JOIN CM_EVENT e
		ON o.EVT_ID = e.EVT_ID
		WHERE 1=1
		<if test="sDate != null and sDate != ''" ><![CDATA[
      	AND #{sDate} <= TO_CHAR(TO_DATE(o.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
		AND #{eDate} >= TO_CHAR(TO_DATE(o.EVT_OCR_YMD_HMS,'YYYYMMDDHH24MISS'),'YYYY-MM-DD')
		]]></if>
		GROUP BY a.DONG_NM, e.EVT_NM
		ORDER BY a.DONG_NM
	</select>
	
	<select id="selectFacilityMapBySi" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		SELECT a.SI_NM as "area", d.DE_CD_NM as "gbn", SUM(1) as "cnt"
		FROM CCTV_BRK_LOG b
		LEFT OUTER JOIN FACILITY_S s
		ON b.FCLT_ID = s.FCLT_ID
		INNER JOIN DETAIL_CD d
		ON s.PURPOSE = d.DE_CD
		INNER JOIN CM_AREA_SI_CD a
		ON SUBSTR(s.AREA_CD::text,1,5) = a.SI_CD::text
		WHERE 1=1
		<if test="sDate != null and sDate != ''" ><![CDATA[
      	AND #{sDate} <= TO_CHAR(b.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
		AND #{eDate} >= TO_CHAR(b.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		GROUP BY a.SI_NM, d.DE_CD_NM
	</select>
	
	<select id="selectFacilityMapByDong" parameterType="map" resultType="com.danusys.web.guardian.common.util.EgovMap">
		SELECT a.DONG_NM as "area", d.DE_CD_NM as "gbn", SUM(1) as "cnt"
		FROM CCTV_BRK_LOG b
		LEFT OUTER JOIN FACILITY_S s
		ON b.FCLT_ID = s.FCLT_ID
		INNER JOIN DETAIL_CD d
		ON s.PURPOSE = d.DE_CD
		INNER JOIN CM_AREA_DONG_CD a
		ON s.AREA_CD::text = a.DONG_CD::text
		AND a.SI_CD::text = #{sigCode}
		WHERE 1=1
		<if test="sDate != null and sDate != ''" ><![CDATA[
      	AND #{sDate} <= TO_CHAR(b.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		<if test="eDate != null and eDate != ''" ><![CDATA[
		AND #{eDate} >= TO_CHAR(b.INSERT_DATE,'YYYY-mm-dd')
		]]></if>
		GROUP BY a.DONG_NM, d.DE_CD_NM
	</select>
</mapper>